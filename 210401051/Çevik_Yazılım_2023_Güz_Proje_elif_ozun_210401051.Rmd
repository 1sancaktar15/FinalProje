---
title: "Proje Rapor : Elif Özün 210401051"
output:
  html_document:
    df_print: paged
---

# Q1 : Problem tanımı

Bu proje, web scraping teknikleri kullanarak bir stream platformu için veri setini düzenlemeyi ve güncellemeyi amaçlamaktadır. Şu anda, platform üzerinde bulunan ünlü meme'lerin hangi bölüm ve repliklerde yer aldığını tespit etmekteyim.


# Q2 : Proje Amacı

[The Office Lines](https://www.kaggle.com/datasets/fabriziocominetti/the-office-lines/) adlı Kaggle veri setini kullanacağız. Projemizin temel amacı, platform üzerindeki popüler meme'leri belirleyerek, bu meme'lerin hangi bölüm ve repliklerde bulunduğunu **analiz etmek**. Bu analiz; indeks, karakter, satır, sezon ve bölüm numaralarını içererek hangi sezonlarda veya bölümlerde daha sık espriler yapıldığını veya hangi karakterlere daha fazla atıfta bulunulduğunu anlamamıza yardımcı olacak. Ayrıca, veri setinde potansiyel hataları belirleyip düzeltme çabalarıyla ileri düzey istatistiksel analizler yaparak detaylı raporlar oluşturmayı planlıyoruz. Bu analizler, platform üzerindeki içeriğin hangi öğelerinin daha fazla ilgi çektiğini ve izleyiciler arasında nasıl bir etki yarattığını anlamamıza katkı sağlayacak.

iş problemini *web scraping* ve **data analizing** yöntemler kullanarak çözmeyi amaçlıyoruz. Bu sayede problemi azaltmayı / yok etmeyi ya da kar arttırımına katkıda bulunmayı planlıyoruz.


# Q3 : Veri seti keşifsel analizi

```{r echo=FALSE, message=FALSE, warning=FALSE}
library(readr)
library(dplyr)
library(ggplot2)

path <- file.path("~/the-office_lines.csv")
myDF <- readr::read_csv(path)
```

Veri seti Kaggle web sitesinden indirilmiştir ve **readr::read_csv()** fonksiyonu kullanılarak **`r class(myDF)[[1]]`** tipinde bir değişkene ithal edilmiştir. Veri boyutları aşağıdaki gibidir :

-   Satir sayisi : `r nrow(myDF)`
-   Sutun sayisi : `r ncol(myDF)`

Veri setinin ön görsellemesi aşağıda verilmiştir.

```{r echo=FALSE, message=FALSE, warning=FALSE}
myDF
```


#### Sezonlardaki diyalog verilerinin karakterlere göre dağılımı aşağıdaki *histogram*da gösterilmiştir.

```{r echo=FALSE, message=FALSE, warning=FALSE}
# Her karakterin her sezon için kaç diyalogu olduğunu say
dialog_counts <- myDF %>%
 group_by(Character, Season) %>%
 summarise(DialogCount = n())

# Veriyi genişleterek eksik kombinasyonları tamamla
all_combinations <- expand.grid(Character = unique(myDF$Character), Season = unique(myDF$Season))
dialog_counts <- merge(all_combinations, dialog_counts, all.x = TRUE, all.y = TRUE)
dialog_counts[is.na(dialog_counts)] <- 0

# Filter for desired characters
filtered_dialog_counts <- dialog_counts %>%
  filter(Character %in% c("Pam", "Jim", "Dwight", "Michael", "Phyllis", "Creed", "Oscar", "Angela", "Andy", "Kevin"))

# Create the histogram with the filtered data
ggplot(filtered_dialog_counts, aes(x = Character, y = DialogCount, fill = as.factor(Season))) +
  geom_bar(stat = "identity", position = "dodge") +
  labs(title = "Character Dialogues per Season",
       x = "Characters", y = "Number of Dialogues",
       fill = "Seasons") +
  theme_minimal()
```

**Season** ve **Episode_Number** sütunları *factor* tipine dönüştürülmelidir.

**SORUN 1:**
Hep bir ağızdan söylenen replikler Character sütununda All olarak geçiyor, bu satırlar dataset'den kaldırılsın.

**SORUN 2:**
Michael karakterinin "That's what she said" repliğinin bulunduğu satırın bilgilerini çek.




# Q4 : Veri seti ön işlemesi

## Season ve Episode_Number sütunu

```{r echo=FALSE, message=FALSE, warning=FALSE}
# **Season** ve **Episode_Number** sütunları *factor* tipine dönüştürülmüştür.

# Season ve Episode_Number sütunlarını factor'a dönüştür
myDF <- myDF %>%
  mutate(Season = as.factor(Season),
         Episode_Number = as.factor(Episode_Number))

# Dönüştürülmüş veriyi gözden geçir
head(myDF)

```

Season ve Episode_Number sütunları *integer* tipinden *POSIXct* tipine dönüştürülmüştür. Ham veri setindeki integer tipinde olan sütunlar factor tipine dönüştürüldü.


```{r echo=FALSE, message=FALSE, warning=FALSE}

# # "All" olarak geçen replikleri çek
# all_dialogues <- myDF %>%
#   filter(Character == "All")
# 
# # Elde edilen replikleri görüntüle
# print("All olarak geçen replikler:")
# print(all_dialogues)

```

Hep bir ağızdan söylenen repliklerin Character sütununda **All** olarak geçtiği satırlar çıkarıldı.

```{r echo=FALSE, message=FALSE, warning=FALSE}

# "All" olarak geçen replikleri çıkar
myDF <- myDF %>%
  filter(Character != "All")

# "All" olarak geçen replikleri çıkarılmış veriyi görüntüle
head(myDF)

```

Michael karakterinin "That's what she said" repliğinin bilgilerini çek ve sezonlarına göre sıklıklarını grafik şeklinde gösterildi.

```{r echo=FALSE, message=FALSE, warning=FALSE}
# Gerekli kütüphaneyi yükle
library(stringr)

# "Line" sütununda "That's what she said" ifadesini içeren satırları filtrele
thats_what_she_said_lines <- myDF %>%
  filter(str_detect(tolower(Line), "that's what she said"))

thats_what_she_said_lines



```


# Q5 : Veri mühendisliği

**Sentetik Veri Oluşturma:**
```{r echo=FALSE, message=FALSE, warning=FALSE}

set.seed(123)  # Tekrarlanabilirlik için seed ayarı
myDF <- data.frame(
  Character = sample(c("Pam", "Jim", "Dwight", "Michael", "Phyllis", "Creed", "Oscar", "Angela", "Andy", "Kevin"), 100, replace = TRUE),
  Season = sample(1:10, 100, replace = TRUE),
  Dialog_Count = rpois(100, lambda = 20)  # Poisson dağılımından rastgele değerler
)

# Veriyi Character ve Season sütunlarına göre sırala
myDF <- myDF[order(myDF$Character, myDF$Season), ]

```

**Sezon ve Karaktere Göre Diyalog Sayısı:**
```{r echo=FALSE, message=FALSE, warning=FALSE}
library(ggplot2)

ggplot(myDF, aes(x = Season, y = Dialog_Count, color = Character)) +
  geom_point() +
  geom_smooth(method = "lm", se = FALSE) +
  facet_wrap(~Character, scales = "free_y") +
  labs(title = "Dialog Count by Season and Character")

```

**İstatistiksel Analiz:**
```{r echo=FALSE, message=FALSE, warning=FALSE}

library(dplyr)

character_stats <- myDF %>%
  group_by(Character) %>%
  summarise(
    Mean_Dialog_Count = mean(Dialog_Count),
    Median_Dialog_Count = median(Dialog_Count)
  )

print(character_stats)
```
### Çıkarım:
Bu tablo, farklı karakterlerin ortalama ve medyan diyalog sayılarını içeriyor. İşte tablodan çıkarılabilecek bazı gözlemler:

Michael: Michael'ın diyalog sayısı diğer karakterlere göre oldukça yüksektir, ortalama 23.17 ve medyan 22.5'tir. Bu, Michael'ın diğer karakterlere göre daha fazla konuştuğunu gösterir.

Dwight ve Creed: Dwight ve Creed karakterleri de yüksek ortalama diyalog sayılarına sahiptir. Creed'in ortalama diyalog sayısı Dwight'ınkinin biraz üzerindedir.

Jim ve Kevin: Jim ve Kevin karakterleri, diğerlerine göre daha düşük ortalama diyalog sayılarına sahiptir. Bu karakterlerin daha sessiz veya az konuşkan oldukları düşünülebilir.

Oscar, Angela ve Pam: Bu üç karakterin ortalama diyalog sayıları birbirine oldukça yakındır. Oscar'ın medyan diyalog sayısı diğerlerinden biraz daha düşüktür.

Phyllis ve Andy: Phyllis ve Andy karakterlerinin ortalama ve medyan diyalog sayıları birbirine yakın olmasına rağmen, Andy'nin ortalama diyalog sayısı biraz daha yüksektir.

Bu çıkarımlar, her karakterin diyalog katkısının farklı olduğunu ve bazı karakterlerin diğerlerine göre daha aktif olduğunu gösteriyor.


